(this["webpackJsonpreact-scenic-spot"]=this["webpackJsonpreact-scenic-spot"]||[]).push([[0],{49:function(e,t,n){},75:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),i=n(21),s=n.n(i),r=n(12),o=(n(49),n(4)),u=n(44),l=n(3),h=n(10),p=n.n(h),j=n(16),y=n(9),m=n(15),d=n(14),v=n(13),b=n(25),C=n(42),g=n.n(C),f=n(43),O=g.a.create({baseURL:"https://ptx.transportdata.tw/MOTC/v2",params:{format:"JSON"}});O.interceptors.request.use((function(e){return e.headers=Object(o.a)(Object(o.a)({},e.headers),function(){var e=(new Date).toGMTString(),t=new f.a("SHA-1","TEXT");t.setHMACKey("tOl73VQNaCJmrbt_FvSSQnBM7JM","TEXT"),t.update("x-date: "+e);var n=t.getHMAC("B64");return{Authorization:'hmac username="'.concat("6719c6e7e3564c948c45a978bc4a9fc2",'", algorithm="hmac-sha1", headers="x-date", signature="').concat(n,'"'),"X-Date":e}}()),e}),null,{synchronous:!0});var x=O,T=function(){var e=Object(j.a)(p.a.mark((function e(t){var n,a,c,i=arguments;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:30,a=i.length>2&&void 0!==i[2]?i[2]:"",e.next=4,x.get("/Tourism/ScenicSpot/".concat(a),{params:{$skip:t,$top:n}});case 4:return c=e.sent,e.abrupt("return",c.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),N=n(1);var w=function(e){var t=e.spot;return Object(N.jsxs)("li",{className:"scenic-spot-list-item list-group-item",children:[Object(N.jsx)("h2",{className:"fw-bold",children:t.Name}),Object(N.jsxs)("div",{className:"mb-2",children:[t.Class1&&Object(N.jsx)("div",{className:"tag",children:t.Class1}),t.Class2&&Object(N.jsx)("div",{className:"tag",children:t.Class2}),t.Class3&&Object(N.jsx)("div",{className:"tag",children:t.Class3})]}),Object(N.jsx)("p",{className:"text-dark my-3",children:t.Description||t.DescriptionDetail}),Object(N.jsxs)("div",{children:[Object(N.jsxs)("p",{className:"m-0 text-muted",children:["\u5730\u5740\uff1a",Object(N.jsx)("a",{href:"https://www.google.com.tw/maps/search/".concat(t.Address),target:"_blank",rel:"noreferrer",children:t.Address})]}),Object(N.jsxs)("p",{className:"m-0 text-muted",children:["\u96fb\u8a71\uff1a",t.Phone]})]})]},t.ID)};var S=function(e){var t,n=e.isLoading,a=e.loadingError;return t=a||(n?"\u8f09\u5165\u4e2d":"\u4e0b\u6ed1\u81f3\u5e95\u8f09\u5165\u66f4\u591a\u8cc7\u6599"),Object(N.jsx)("li",{className:"list-group-item text-center",children:t})};function D(e){var t,n=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300;return function(){for(var c=arguments.length,i=new Array(c),s=0;s<c;s++)i[s]=arguments[s];clearTimeout(t),t=setTimeout((function(){e.apply(n,i)}),a)}}var M=[void 0,"Taipei","NewTaipei","Taoyuan","Taichung","Tainan","Kaohsiung","Keelung","Hsinchu","HsinchuCounty","MiaoliCounty","ChanghuaCounty","NantouCounty","YunlinCounty","ChiayiCounty","Chiayi","PingtungCounty","YilanCounty","HualienCounty","TaitungCounty","KinmenCounty","PenghuCounty","LienchiangCounty"],k=function(e){Object(d.a)(n,e);var t=Object(v.a)(n);function n(e){var a;return Object(y.a)(this,n),(a=t.call(this,e)).checkScrollPosition=function(){var e=Object(j.a)(p.a.mark((function e(t){var n,c,i,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.props.hasMoreDataToFetch&&!a.props.searchTerm){e.next=2;break}return e.abrupt("return");case 2:if(n=t.target,c=n.offsetHeight,i=n.scrollTop,s=n.scrollHeight,0===i||c+i!==s||a.state.isFetching){e.next=14;break}return a.setState({isFetching:!0,loadingError:null}),e.prev=5,e.next=8,a.fetchData();case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(5),a.setState({loadingError:"\u51fa\u73fe\u932f\u8aa4\uff0c\u8acb\u91cd\u65b0\u5617\u8a66"});case 13:a.setState({isFetching:!1});case 14:case"end":return e.stop()}}),e,null,[[5,10]])})));return function(t){return e.apply(this,arguments)}}(),a.fetchData=Object(j.a)(p.a.mark((function e(){var t,n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.props.hasMoreDataToFetch){e.next=2;break}return e.abrupt("return");case 2:return a.props.spots.length,t=30,e.next=5,T(a.props.spots.length,t,a.props.city);case 5:n=e.sent,a.props.saveScenicSpot(a.props.city,n),n.length<30&&a.props.updateCityInfo(a.props.city,!1);case 8:case"end":return e.stop()}}),e)}))),a.state={isFetching:!1,loadingError:null},a.spotListRef=c.a.createRef(),a}return Object(m.a)(n,[{key:"componentDidMount",value:function(){var e=Object(j.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.fetchData();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(j.a)(p.a.mark((function e(t){var n,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.city,a=this.props.city,n!==a&&(this.spotListRef.current.scrollTop=0,0===this.props.spots.length&&this.fetchData());case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;if(!M.includes(this.props.city))return Object(N.jsx)(l.a,{to:"/scenicSpot"});var t=this.props.spots.filter((function(t){return t.Name.match(e.props.searchTerm)})).map((function(e){return Object(N.jsx)(w,{spot:e},e.ID)})),n=this.state.isFetching||0===this.props.spots.length,a=this.props.hasMoreDataToFetch&&!this.props.searchTerm;return Object(N.jsx)("div",{className:"scenicSpot container overflow-auto",children:Object(N.jsxs)("ul",{className:"list-group overflow-auto h-100 py-3",onScroll:D(this.checkScrollPosition),ref:this.spotListRef,children:[t,a&&Object(N.jsx)(S,{isLoading:n,loadingError:this.state.loadingError})]})})}}]),n}(a.Component),F=Object(b.b)((function(e,t){var n=t.match.params.city,a=void 0!==n?e.hasMoreDataToFetch[n]:e.hasMoreDataToFetch.Taiwan;return{spots:e.spots[n]||e.spots.Taiwan,hasMoreDataToFetch:a,city:n,searchTerm:t.searchTerm}}),(function(e){return{saveScenicSpot:function(t,n){e(function(){return{type:"SAVE_SCENIC_SPOT",city:arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Taiwan",newData:arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]}}(t,n))},updateCityInfo:function(t,n){e(function(){return{type:"UPDATE_CITY_INFO",city:arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Taiwan",hasMoreDataToFetch:arguments.length>1?arguments[1]:void 0}}(t,n))}}}))(k);var H=function(){return Object(N.jsx)("div",{className:"h-100 d-flex flex-column justify-content-center text-center",children:Object(N.jsxs)("div",{children:[Object(N.jsx)("h1",{className:"mb-5",children:"Oops\uff01\u597d\u50cf\u8ff7\u8def\u4e86"}),Object(N.jsx)(r.b,{to:"/scenicSpot",className:"btn btn-lg btn-info",children:"\u56de\u53bb\u700f\u89bd\u666f\u9ede"})]})})};var P=function(){return Object(N.jsx)("div",{className:"welcome h-100 d-flex flex-column justify-content-center text-center",children:Object(N.jsxs)("div",{children:[Object(N.jsx)("h1",{className:"mb-5",children:"\u6b61\u8fce\u5149\u81e8\uff61:.\uff9f\u30fd(*\xb4\u2200`)\uff89\uff9f.:\uff61"}),Object(N.jsx)(r.b,{to:"/scenicSpot",className:"btn btn-lg btn-info",children:"\u958b\u59cb\u700f\u89bd\u666f\u9ede"})]})})};var K=function(e){var t=e.searchTerm,n=e.setSearchTerm;return Object(N.jsxs)("div",{className:"input-group",children:[Object(N.jsx)("input",{type:"text",className:"form-control",placeholder:"\u7be9\u9078\u666f\u9ede\u540d\u7a31",value:t,onChange:function(e){n(e.target.value.trim())}}),Object(N.jsx)("button",{className:"btn btn-secondary",onClick:function(){n("")},children:"\u6e05\u9664"})]})},E=[{value:"default",name:"\u8acb\u9078\u64c7\u7bc4\u570d"},{value:"",name:"\u5168\u53f0\u666f\u9ede Taiwan"},{value:"Taipei",name:"\u81fa\u5317\u5e02 Taipei"},{value:"NewTaipei",name:"\u65b0\u5317\u5e02 NewTaipei"},{value:"Taoyuan",name:"\u6843\u5712\u5e02 Taoyuan"},{value:"Taichung",name:"\u81fa\u4e2d\u5e02 Taichung"},{value:"Tainan",name:"\u81fa\u5357\u5e02 Tainan"},{value:"Kaohsiung",name:"\u9ad8\u96c4\u5e02 Kaohsiung"},{value:"Keelung",name:"\u57fa\u9686\u5e02 Keelung"},{value:"Hsinchu",name:"\u65b0\u7af9\u5e02 Hsinchu"},{value:"HsinchuCounty",name:"\u65b0\u7af9\u7e23 HsinchuCounty"},{value:"MiaoliCounty",name:"\u82d7\u6817\u7e23 MiaoliCounty"},{value:"ChanghuaCounty",name:"\u5f70\u5316\u7e23 ChanghuaCounty"},{value:"NantouCounty",name:"\u5357\u6295\u7e23 NantouCounty"},{value:"YunlinCounty",name:"\u96f2\u6797\u7e23 YunlinCounty"},{value:"ChiayiCounty",name:"\u5609\u7fa9\u7e23 ChiayiCounty"},{value:"Chiayi",name:"\u5609\u7fa9\u5e02 Chiayi"},{value:"PingtungCounty",name:"\u5c4f\u6771\u7e23 PingtungCounty"},{value:"YilanCounty",name:"\u5b9c\u862d\u7e23 YilanCounty"},{value:"HualienCounty",name:"\u82b1\u84ee\u7e23 HualienCounty"},{value:"TaitungCounty",name:"\u81fa\u6771\u7e23 TaitungCounty"},{value:"KinmenCounty",name:"\u91d1\u9580\u7e23 KinmenCounty"},{value:"PenghuCounty",name:"\u6f8e\u6e56\u7e23 PenghuCounty"},{value:"LienchiangCounty",name:"\u9023\u6c5f\u7e23 LienchiangCounty"}],A=function(e){Object(d.a)(n,e);var t=Object(v.a)(n);function n(){var e;Object(y.a)(this,n);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(e=t.call.apply(t,[this].concat(c))).state={selectedCity:""},e.handleSelectCity=function(t){e.setState({selectedCity:t.target.value}),e.props.history.push("/scenicSpot/".concat(t.target.value))},e}return Object(m.a)(n,[{key:"componentDidMount",value:function(){var e=Object(l.f)(window.location.pathname,{path:"".concat("/react-scenic-spot","/scenicSpot/:city?")});e&&this.setState({selectedCity:e.params.city})}},{key:"render",value:function(){var e=E.map((function(e){return Object(N.jsx)("option",{value:e.value,disabled:"default"===e.value||null,children:e.name},e.value)}));return Object(N.jsx)("select",{className:"form-select",id:"citySelect",onChange:this.handleSelectCity,value:this.state.selectedCity,children:e})}}]),n}(a.Component),Y=Object(l.g)(A);var I=function(e){return Object(N.jsx)("nav",{className:"navbar navbar-light bg-light",children:Object(N.jsx)("div",{className:"container",children:Object(N.jsxs)("div",{className:"row",children:[Object(N.jsx)("div",{className:"col",children:Object(N.jsx)(Y,{})}),Object(N.jsx)("div",{className:"col",children:Object(N.jsx)(K,{searchTerm:e.searchTerm,setSearchTerm:e.setSearchTerm})})]})})})};var L=function(){var e=Object(a.useState)(""),t=Object(u.a)(e,2),n=t[0],c=t[1];return Object(N.jsxs)("div",{className:"app vh-100 d-flex flex-column",children:[Object(N.jsx)(I,{searchTerm:n,setSearchTerm:c}),Object(N.jsx)("div",{className:"d-flex flex-column overflow-auto h-100",children:Object(N.jsxs)(l.d,{children:[Object(N.jsx)(l.b,{path:"/",exact:!0,component:P}),Object(N.jsx)(l.b,{path:"/scenicSpot/:city?",render:function(e){return Object(N.jsx)(F,Object(o.a)(Object(o.a)({},e),{},{searchTerm:n}))}}),Object(N.jsx)(l.b,{path:"*",component:H})]})})]})},_=n(24),J=n(18),R=n(31),U={spots:{Taiwan:[],Taipei:[],NewTaipei:[],Taoyuan:[],Taichung:[],Tainan:[],Kaohsiung:[],Keelung:[],Hsinchu:[],HsinchuCounty:[],MiaoliCounty:[],ChanghuaCounty:[],NantouCounty:[],YunlinCounty:[],ChiayiCounty:[],Chiayi:[],PingtungCounty:[],YilanCounty:[],HualienCounty:[],TaitungCounty:[],KinmenCounty:[],PenghuCounty:[],LienchiangCounty:[]},isFetching:!1,hasMoreDataToFetch:{Taiwan:!0,Taipei:!0,NewTaipei:!0,Taoyuan:!0,Taichung:!0,Tainan:!0,Kaohsiung:!0,Keelung:!0,Hsinchu:!0,HsinchuCounty:!0,MiaoliCounty:!0,ChanghuaCounty:!0,NantouCounty:!0,YunlinCounty:!0,ChiayiCounty:!0,Chiayi:!0,PingtungCounty:!0,YilanCounty:!0,HualienCounty:!0,TaitungCounty:!0,KinmenCounty:!0,PenghuCounty:!0,LienchiangCounty:!0}},B=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:U,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SAVE_SCENIC_SPOT":var n=t.city,a=t.newData,c=Object(o.a)(Object(o.a)({},e.spots),{},Object(J.a)({},n,[].concat(Object(R.a)(e.spots[n]),Object(R.a)(a))));return Object(o.a)(Object(o.a)({},e),{},{spots:c});case"UPDATE_CITY_INFO":var i=t.city,s=t.hasMoreDataToFetch,r=Object(o.a)(Object(o.a)({},e.hasMoreDataToFetch),{},Object(J.a)({},i,s));return Object(o.a)(Object(o.a)({},e),{},{hasMoreDataToFetch:r});default:return e}},V=Object(_.b)(B);s.a.render(Object(N.jsx)(c.a.StrictMode,{children:Object(N.jsx)(b.a,{store:V,children:Object(N.jsx)(r.a,{basename:"/react-scenic-spot",children:Object(N.jsx)(L,{})})})}),document.getElementById("root"))}},[[75,1,2]]]);
//# sourceMappingURL=main.37763c65.chunk.js.map
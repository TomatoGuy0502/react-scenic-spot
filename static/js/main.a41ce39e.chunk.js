(this["webpackJsonpreact-scenic-spot"]=this["webpackJsonpreact-scenic-spot"]||[]).push([[0],{46:function(t,e,n){},72:function(t,e,n){"use strict";n.r(e);var a=n(0),c=n.n(a),i=n(20),s=n.n(i),o=n(14),r=(n(46),n(3)),u=n(9),l=n.n(u),h=n(16),p=n(8),y=n(15),j=n(13),C=n(12),v=n(10),d=n(39),b=n.n(d),m=n(40),g=b.a.create({baseURL:"https://ptx.transportdata.tw/MOTC/v2",params:{format:"JSON"}});g.interceptors.request.use((function(t){return t.headers=Object(v.a)(Object(v.a)({},t.headers),function(){var t=(new Date).toGMTString(),e=new m.a("SHA-1","TEXT");e.setHMACKey("tOl73VQNaCJmrbt_FvSSQnBM7JM","TEXT"),e.update("x-date: "+t);var n=e.getHMAC("B64");return{Authorization:'hmac username="'.concat("6719c6e7e3564c948c45a978bc4a9fc2",'", algorithm="hmac-sha1", headers="x-date", signature="').concat(n,'"'),"X-Date":t}}()),t}),null,{synchronous:!0});var f=g,O=function(){var t=Object(h.a)(l.a.mark((function t(e){var n,a,c,i=arguments;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:30,a=i.length>2&&void 0!==i[2]?i[2]:"",t.next=4,f.get("/Tourism/ScenicSpot/".concat(a),{params:{$skip:e,$top:n}});case 4:return c=t.sent,t.abrupt("return",c.data);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),x=n(1);var T=function(t){var e=t.spot;return Object(x.jsxs)("li",{className:"scenic-spot-list-item list-group-item",children:[Object(x.jsx)("h2",{className:"fw-bold",children:e.Name}),Object(x.jsxs)("div",{className:"mb-2",children:[e.Class1&&Object(x.jsx)("div",{className:"tag",children:e.Class1}),e.Class2&&Object(x.jsx)("div",{className:"tag",children:e.Class2}),e.Class3&&Object(x.jsx)("div",{className:"tag",children:e.Class3})]}),Object(x.jsx)("p",{className:"text-dark my-3",children:e.Description||e.DescriptionDetail}),Object(x.jsxs)("div",{children:[Object(x.jsxs)("p",{className:"m-0 text-muted",children:["\u5730\u5740\uff1a",e.Address]}),Object(x.jsxs)("p",{className:"m-0 text-muted",children:["\u96fb\u8a71\uff1a",e.Phone]})]})]},e.ID)};var w=function(t){var e=t.isLoading?"\u8f09\u5165\u4e2d":"\u4e0b\u6ed1\u81f3\u5e95\u8f09\u5165\u66f4\u591a\u8cc7\u6599";return Object(x.jsx)("li",{children:e})},N=n(23),S=[void 0,"Taipei","NewTaipei","Taoyuan","Taichung","Tainan","Kaohsiung","Keelung","Hsinchu","HsinchuCounty","MiaoliCounty","ChanghuaCounty","NantouCounty","YunlinCounty","ChiayiCounty","Chiayi","PingtungCounty","YilanCounty","HualienCounty","TaitungCounty","KinmenCounty","PenghuCounty","LienchiangCounty"],D=function(t){Object(j.a)(n,t);var e=Object(C.a)(n);function n(t){var a;return Object(p.a)(this,n),(a=e.call(this,t)).checkScrollPosition=function(){var t=Object(h.a)(l.a.mark((function t(e){var n,c,i,s;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.props.hasMoreDataToFetch){t.next=2;break}return t.abrupt("return");case 2:if(n=e.target,c=n.offsetHeight,i=n.scrollTop,s=n.scrollHeight,0===i||c+i!==s||a.state.isFetching){t.next=14;break}return a.setState({isFetching:!0}),t.prev=5,t.next=8,a.fetchData();case 8:t.next=13;break;case 10:t.prev=10,t.t0=t.catch(5),console.error(t.t0);case 13:a.setState({isFetching:!1});case 14:case"end":return t.stop()}}),t,null,[[5,10]])})));return function(e){return t.apply(this,arguments)}}(),a.fetchData=Object(h.a)(l.a.mark((function t(){var e,n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.props.hasMoreDataToFetch){t.next=2;break}return t.abrupt("return");case 2:return a.props.spots.length,e=30,t.next=5,O(a.props.spots.length,e,a.props.city);case 5:n=t.sent,a.props.saveScenicSpot(a.props.city,n),n.length<30&&a.props.updateCityInfo(a.props.city,!1);case 8:case"end":return t.stop()}}),t)}))),a.state={isFetching:!1},a.spotListRef=c.a.createRef(),a}return Object(y.a)(n,[{key:"componentDidMount",value:function(){var t=Object(h.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.fetchData();case 1:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var t=Object(h.a)(l.a.mark((function t(e){var n,a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=e.city,a=this.props.city,n!==a&&(this.spotListRef.current.scrollTop=0,0===this.props.spots.length&&this.fetchData());case 3:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"render",value:function(){if(!S.includes(this.props.city))return Object(x.jsx)(r.a,{to:"/scenicSpot"});var t=this.props.spots.map((function(t){return Object(x.jsx)(T,{spot:t},t.ID)})),e=this.state.isFetching||0===this.props.spots.length;return Object(x.jsx)("div",{className:"scenicSpot overflow-auto",children:Object(x.jsxs)("ul",{className:"list-group overflow-auto h-100 py-3",onScroll:this.checkScrollPosition,ref:this.spotListRef,children:[t,this.props.hasMoreDataToFetch&&Object(x.jsx)(w,{isLoading:e})]})})}}]),n}(a.Component),M=Object(N.b)((function(t,e){var n=e.match.params.city,a=void 0!==n?t.hasMoreDataToFetch[n]:t.hasMoreDataToFetch.Taiwan;return{spots:t.spots[n]||t.spots.Taiwan,hasMoreDataToFetch:a,city:n}}),(function(t){return{saveScenicSpot:function(e,n){t(function(){return{type:"SAVE_SCENIC_SPOT",city:arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Taiwan",newData:arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]}}(e,n))},updateCityInfo:function(e,n){t(function(){return{type:"UPDATE_CITY_INFO",city:arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Taiwan",hasMoreDataToFetch:arguments.length>1?arguments[1]:void 0}}(e,n))}}}))(D);var F=function(){var t=Object(r.g)();return Object(x.jsx)("div",{children:Object(x.jsxs)("h3",{children:["Oops! \u627e\u4e0d\u5230 ",Object(x.jsx)("code",{children:t.pathname})]})})};var k=function(){return Object(x.jsxs)("div",{children:[Object(x.jsx)("h1",{children:"\u6b61\u8fce\u5149\u81e8\uff61:.\uff9f\u30fd(*\xb4\u2200`)\uff89\uff9f.:\uff61"}),Object(x.jsx)(o.b,{to:"/scenicSpot",children:"\u524d\u5f80\u67e5\u770b\u666f\u9ede"})]})},H=[{value:"",name:"\u5168\u53f0\u666f\u9ede Taiwan"},{value:"Taipei",name:"\u81fa\u5317\u5e02 Taipei"},{value:"NewTaipei",name:"\u65b0\u5317\u5e02 NewTaipei"},{value:"Taoyuan",name:"\u6843\u5712\u5e02 Taoyuan"},{value:"Taichung",name:"\u81fa\u4e2d\u5e02 Taichung"},{value:"Tainan",name:"\u81fa\u5357\u5e02 Tainan"},{value:"Kaohsiung",name:"\u9ad8\u96c4\u5e02 Kaohsiung"},{value:"Keelung",name:"\u57fa\u9686\u5e02 Keelung"},{value:"Hsinchu",name:"\u65b0\u7af9\u5e02 Hsinchu"},{value:"HsinchuCounty",name:"\u65b0\u7af9\u7e23 HsinchuCounty"},{value:"MiaoliCounty",name:"\u82d7\u6817\u7e23 MiaoliCounty"},{value:"ChanghuaCounty",name:"\u5f70\u5316\u7e23 ChanghuaCounty"},{value:"NantouCounty",name:"\u5357\u6295\u7e23 NantouCounty"},{value:"YunlinCounty",name:"\u96f2\u6797\u7e23 YunlinCounty"},{value:"ChiayiCounty",name:"\u5609\u7fa9\u7e23 ChiayiCounty"},{value:"Chiayi",name:"\u5609\u7fa9\u5e02 Chiayi"},{value:"PingtungCounty",name:"\u5c4f\u6771\u7e23 PingtungCounty"},{value:"YilanCounty",name:"\u5b9c\u862d\u7e23 YilanCounty"},{value:"HualienCounty",name:"\u82b1\u84ee\u7e23 HualienCounty"},{value:"TaitungCounty",name:"\u81fa\u6771\u7e23 TaitungCounty"},{value:"KinmenCounty",name:"\u91d1\u9580\u7e23 KinmenCounty"},{value:"PenghuCounty",name:"\u6f8e\u6e56\u7e23 PenghuCounty"},{value:"LienchiangCounty",name:"\u9023\u6c5f\u7e23 LienchiangCounty"}],P=function(t){Object(j.a)(n,t);var e=Object(C.a)(n);function n(){var t;Object(p.a)(this,n);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(t=e.call.apply(e,[this].concat(c))).state={selectedCity:""},t.handleSelectCity=function(e){t.setState({selectedCity:e.target.value}),t.props.history.push("/scenicSpot/".concat(e.target.value))},t.selectAllCity=function(e){t.setState({selectedCity:""}),t.props.history.push("/scenicSpot")},t}return Object(y.a)(n,[{key:"componentDidMount",value:function(){var t=Object(r.f)(window.location.pathname,{path:"/scenicSpot/:city?"});t&&this.setState({selectedCity:t.params.city})}},{key:"render",value:function(){var t=H.map((function(t){return Object(x.jsx)("option",{value:t.value,children:t.name},t.value)}));return Object(x.jsx)("nav",{className:"navbar navbar-light bg-light",children:Object(x.jsx)("div",{className:"container-fluid",children:Object(x.jsxs)("div",{className:"row",children:[Object(x.jsx)("label",{className:"col-auto col-form-label",htmlFor:"citySelect",children:"\u8acb\u9078\u64c7\u666f\u9ede\u7bc4\u570d"}),Object(x.jsx)("div",{className:"col",children:Object(x.jsx)("select",{className:"form-select",id:"citySelect",onChange:this.handleSelectCity,value:this.state.selectedCity,children:t})}),Object(x.jsx)("div",{className:"col",children:Object(x.jsx)("input",{type:"text",className:"form-control",placeholder:"\u7be9\u9078\u666f\u9ede\u540d\u7a31"})})]})})})}}]),n}(a.Component),K=Object(r.h)(P);var Y=function(){return Object(x.jsxs)("div",{className:"app vh-100 d-flex flex-column",children:[Object(x.jsx)(K,{}),Object(x.jsx)("div",{className:"container d-flex flex-column overflow-auto",children:Object(x.jsxs)(r.d,{children:[Object(x.jsx)(r.b,{path:"/",exact:!0,component:k}),Object(x.jsx)(r.b,{path:"/scenicSpot/:city?",component:M}),Object(x.jsx)(r.b,{path:"*",component:F})]})})]})},A=n(22),I=n(18),L=n(29),E={spots:{Taiwan:[],Taipei:[],NewTaipei:[],Taoyuan:[],Taichung:[],Tainan:[],Kaohsiung:[],Keelung:[],Hsinchu:[],HsinchuCounty:[],MiaoliCounty:[],ChanghuaCounty:[],NantouCounty:[],YunlinCounty:[],ChiayiCounty:[],Chiayi:[],PingtungCounty:[],YilanCounty:[],HualienCounty:[],TaitungCounty:[],KinmenCounty:[],PenghuCounty:[],LienchiangCounty:[]},isFetching:!1,hasMoreDataToFetch:{Taiwan:!0,Taipei:!0,NewTaipei:!0,Taoyuan:!0,Taichung:!0,Tainan:!0,Kaohsiung:!0,Keelung:!0,Hsinchu:!0,HsinchuCounty:!0,MiaoliCounty:!0,ChanghuaCounty:!0,NantouCounty:!0,YunlinCounty:!0,ChiayiCounty:!0,Chiayi:!0,PingtungCounty:!0,YilanCounty:!0,HualienCounty:!0,TaitungCounty:!0,KinmenCounty:!0,PenghuCounty:!0,LienchiangCounty:!0}},_=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"SAVE_SCENIC_SPOT":var n=e.city,a=e.newData,c=Object(v.a)(Object(v.a)({},t.spots),{},Object(I.a)({},n,[].concat(Object(L.a)(t.spots[n]),Object(L.a)(a))));return Object(v.a)(Object(v.a)({},t),{},{spots:c});case"UPDATE_CITY_INFO":var i=e.city,s=e.hasMoreDataToFetch,o=Object(v.a)(Object(v.a)({},t.hasMoreDataToFetch),{},Object(I.a)({},i,s));return Object(v.a)(Object(v.a)({},t),{},{hasMoreDataToFetch:o});default:return t}},J=Object(A.b)(_);s.a.render(Object(x.jsx)(c.a.StrictMode,{children:Object(x.jsx)(N.a,{store:J,children:Object(x.jsx)(o.a,{basename:"/TomatoGuy0502/react-scenic-spot",children:Object(x.jsx)(Y,{})})})}),document.getElementById("root"))}},[[72,1,2]]]);
//# sourceMappingURL=main.a41ce39e.chunk.js.map